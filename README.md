# TFM_DirectedStimulationSimulation
# Electrode Stimulation in PBS Petri Dish ‚Äî Simulation and Analysis

This repository contains MATLAB simulations and analysis scripts for modeling electric fields generated by electrode pads in a phosphate-buffered saline (PBS)‚Äìfilled petri dish using the scalar partial differential equation (PDE) approach in the frequency domain. It also includes analysis of corresponding experimental data.

## üìÅ Contents

- **`Simulation2.mlx`**  
  Simulates voltage distributions in a PBS-filled petri dish using four electrode pads. The PDE solver models the frequency-domain response of the conductive medium, allowing comparison with experimental measurements. It includes:
  - Definition of electrode geometry and materials
  - Mesh generation with local refinement
  - PDE solution and visualization
  - Quantitative comparison with experimental voltage measurements
  - Scatter and Bland‚ÄìAltman analysis

- **`Simulation3.mlx`**  
  Simulates time-varying beat envelope fields resulting from the superposition of two close frequencies (e.g. 1000 Hz and 1010 Hz) applied to different electrodes. Highlights:
  - Frequency-specific PDE solutions
  - Envelope field computation
  - Visualization of beat amplitudes
  - Time-domain reconstruction and envelope extraction via the Hilbert transform

- **`Data_analysis_TIS.mlx`**  
  Downloads and processes experimental waveform data from a Google Sheets CSV. The script:
  - Downloads CSV data directly from Google Sheets
  - Parses and cleans the signal
  - Visualizes the raw oscilloscope data

## üß™ Requirements

- MATLAB R2020b or later (recommended)
- Required Toolboxes:
  - Partial Differential Equation Toolbox
  - Signal Processing Toolbox (for Hilbert transform)
- Internet connection (for downloading data in `Data_analysis_TIS.mlx`)

## ‚ñ∂Ô∏è How to Run

1. Open any of the `.mlx` files in MATLAB Live Editor.
2. Run the sections sequentially or the whole script at once.
3. Make sure to allow web access for `Data_analysis_TIS.mlx` when prompted.

## üìå Notes

- The simulations assume a circular petri dish of 90 mm diameter with electrode pads placed symmetrically.
- The analysis in `Simulation2.mlx` compares simulated and experimental voltage values quantitatively.
- `Simulation3.mlx` demonstrates the concept of beat stimulation, useful in neuromodulation strategies.
- The experimental data source is linked [here](https://docs.google.com/spreadsheets/d/1YDlMPtYdSVsHdrFVt8_7MTUF_CIstmmzhMWmsxN5lXA/edit?usp=sharing).

## üì∑ Example Outputs

- Voltage magnitude maps over petri dish
- Beat envelope field visualizations
- Scatter plots of simulated vs. measured voltages
- Bland‚ÄìAltman plots

---

## üìß Contact

For questions, please reach out via the Issues tab or contact the repository owner directly.

